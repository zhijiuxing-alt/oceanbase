gv$sql_audit 
=================================



功能 
-----------

该视图用于展示所有 Server 上每一次 SQL 请求的来源、执行状态等统计信息。该视图是按照租户拆分的，除了系统租户，其他租户不能跨租户查询。

相关表/视图 
---------------

__all_virtual_sql_audit

字段说明 
-------------



|        **字段名称**         |       **类型**        | **是否可以为 NULL** |                                                                                                                                                                                                            **描述**                                                                                                                                                                                                             |
|-------------------------|---------------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SVR_IP                  | varchar(32)         | NO             | IP 地址                                                                                                                                                                                                                                                                                                                                                                                                                         |
| SVR_PORT                | bigint(20)          | NO             | 端口号                                                                                                                                                                                                                                                                                                                                                                                                                           |
| REQUEST_ID              | bigint(20)          | NO             | 请求的 ID 号                                                                                                                                                                                                                                                                                                                                                                                                                      |
| TRACE_ID                | varchar(128)        | NO             | 该语句的 trace_id                                                                                                                                                                                                                                                                                                                                                                                                                 |
| SID                     | bigint(20) unsigned | NO             | Session 连接 ID                                                                                                                                                                                                                                                                                                                                                                                                                 |
| CLIENT_IP               | varchar(32)         | NO             | 发送请求的客户端 IP                                                                                                                                                                                                                                                                                                                                                                                                                   |
| CLIENT_PORT             | bigint(20)          | NO             | 发送请求的客户端端口号                                                                                                                                                                                                                                                                                                                                                                                                                   |
| TENANT_ID               | bigint(20)          | NO             | 发送请求的租户 ID                                                                                                                                                                                                                                                                                                                                                                                                                    |
| TENANT_NAME             | varchar(64)         | NO             | 发送请求的租户名称                                                                                                                                                                                                                                                                                                                                                                                                                     |
| EFFECTIVE_TENANT_ID     | bigint(20)          | NO             | 租户 ID                                                                                                                                                                                                                                                                                                                                                                                                                         |
| USER_ID                 | bigint(20)          | NO             | 发送请求的用户 ID                                                                                                                                                                                                                                                                                                                                                                                                                    |
| USER_NAME               | varchar(64)         | NO             | 发送请求的用户名称                                                                                                                                                                                                                                                                                                                                                                                                                     |
| USER_CLIENT_IP          | varchar(32)         | NO             | 发送请求的客户端 IP                                                                                                                                                                                                                                                                                                                                                                                                                   |
| DB_ID                   | bigint(20) unsigned | DB_ID          | 数据库 ID                                                                                                                                                                                                                                                                                                                                                                                                                        |
| DB_NAME                 | varchar(128)        | DB_NAME        | 数据库名称                                                                                                                                                                                                                                                                                                                                                                                                                         |
| SQL_ID                  | varchar(32)         | NO             | 该 SQL 的 ID                                                                                                                                                                                                                                                                                                                                                                                                                    |
| QUERY_SQL               | varchar(65536)      | NO             | 实际的 SQL 语句                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PLAN_ID                 | bigint(20)          | NO             | 执行计划的 ID                                                                                                                                                                                                                                                                                                                                                                                                                      |
| AFFECTED_ROWS           | bigint(20)          | NO             | 影响行数                                                                                                                                                                                                                                                                                                                                                                                                                          |
| RETURN_ROWS             | bigint(20)          | NO             | 返回行数                                                                                                                                                                                                                                                                                                                                                                                                                          |
| PARTITION_CNT           | bigint(20)          | NO             | 该请求涉及的分区数                                                                                                                                                                                                                                                                                                                                                                                                                     |
| RET_CODE                | bigint(20)          | NO             | 执行结果返回码                                                                                                                                                                                                                                                                                                                                                                                                                       |
| QC_ID                   | bigint(20) unsigned | NO             | 并行执行场景下，调度器 ID                                                                                                                                                                                                                                                                                                                                                                                                                |
| DFO_ID                  | bigint(20)          | NO             | 并行执行场景下，当前执行的子计划 ID                                                                                                                                                                                                                                                                                                                                                                                                           |
| SQC_ID                  | bigint(20)          | NO             | 并行执行场景下，本地协调器 ID                                                                                                                                                                                                                                                                                                                                                                                                              |
| WORKER_ID               | bigint(20)          | NO             | 并行执行场景下，工作线程 ID                                                                                                                                                                                                                                                                                                                                                                                                               |
| EVENT                   | varchar(64)         | NO             | 最长等待事件名称                                                                                                                                                                                                                                                                                                                                                                                                                      |
| P1TEXT                  | varchar(64)         | NO             | 等待事件参数 1                                                                                                                                                                                                                                                                                                                                                                                                                      |
| P1                      | bigint(20) unsigned | NO             | 等待事件参数 1 的值                                                                                                                                                                                                                                                                                                                                                                                                                   |
| P2TEXT                  | varchar(64)         | NO             | 等待事件参数 2                                                                                                                                                                                                                                                                                                                                                                                                                      |
| P2                      | bigint(20) unsigned | NO             | 等待事件参数 2 的值                                                                                                                                                                                                                                                                                                                                                                                                                   |
| P3TEXT                  | varchar(64)         | NO             | 等待事件参数 3                                                                                                                                                                                                                                                                                                                                                                                                                      |
| P3                      | bigint(20) unsigned | NO             | 等待事件参数 3 的值                                                                                                                                                                                                                                                                                                                                                                                                                   |
| LEVEL                   | bigint(20)          | NO             | 等待事件的级别                                                                                                                                                                                                                                                                                                                                                                                                                       |
| WAIT_CLASS_ID           | bigint(20)          | NO             | 等待事件所属的 Class ID                                                                                                                                                                                                                                                                                                                                                                                                              |
| WAIT_CLASS#             | bigint(20)          | NO             | 等待事件所属的 Class 的下标                                                                                                                                                                                                                                                                                                                                                                                                             |
| WAIT_CLASS              | varchar(64)         | NO             | 等待事件所属的 Class 名称                                                                                                                                                                                                                                                                                                                                                                                                              |
| STATE                   | varchar(19)         | NO             | 等待事件的状态                                                                                                                                                                                                                                                                                                                                                                                                                       |
| WAIT_TIME_MICRO         | bigint(20)          | NO             | 该等待事件所等待的时间，单位：微秒                                                                                                                                                                                                                                                                                                                                                                                                             |
| TOTAL_WAIT_TIME_MICRO   | bigint(20)          | NO             | 执行过程所有等待的总时间，单位：微秒                                                                                                                                                                                                                                                                                                                                                                                                            |
| TOTAL_WAITS             | bigint(20)          | NO             | 执行过程总等待的次数                                                                                                                                                                                                                                                                                                                                                                                                                    |
| RPC_COUNT               | bigint(20)          | NO             | 发送的 RPC 个数                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PLAN_TYPE               | bigint(20)          | NO             | 执行计划类型： * local   * remote   * distribute                                                                                                                                                                                                                                                 |
| IS_INNER_SQL            | tinyint(4)          | NO             | 是否为内部 SQL 请求                                                                                                                                                                                                                                                                                                                                                                                                                  |
| IS_EXECUTOR_RPC         | tinyint(4)          | NO             | 当前请求是否为 RPC 请求                                                                                                                                                                                                                                                                                                                                                                                                                |
| IS_HIT_PLAN             | tinyint(4)          | NO             | 是否命中 plan_cache                                                                                                                                                                                                                                                                                                                                                                                                               |
| REQUEST_TIME            | bigint(20)          | NO             | 开始执行时间点                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ELAPSED_TIME            | bigint(20)          | NO             | 接收到请求到执行结束所消耗的总时间                                                                                                                                                                                                                                                                                                                                                                                                             |
| NET_TIME                | bigint(20)          | NO             | 发送 RPC 到接收到请求的时间                                                                                                                                                                                                                                                                                                                                                                                                              |
| NET_WAIT_TIME           | bigint(20)          | NO             | 接收到请求到进入队列的时间                                                                                                                                                                                                                                                                                                                                                                                                                 |
| QUEUE_TIME              | bigint(20)          | NO             | 请求在队列的等待时间                                                                                                                                                                                                                                                                                                                                                                                                                    |
| DECODE_TIME             | bigint(20)          | NO             | 出队列后 decode 的时间                                                                                                                                                                                                                                                                                                                                                                                                               |
| GET_PLAN_TIME           | bigint(20)          | NO             | 开始 process 到获得计划的时间                                                                                                                                                                                                                                                                                                                                                                                                           |
| EXECUTE_TIME            | bigint(20)          | NO             | 计划执行所消耗的时间                                                                                                                                                                                                                                                                                                                                                                                                                    |
| APPLICATION_WAIT_TIME   | bigint(20) unsigned | NO             | 所有 application 类事件的总时间                                                                                                                                                                                                                                                                                                                                                                                                        |
| CONCURRENCY_WAIT_TIME   | bigint(20) unsigned | NO             | 所有 concurrency 类事件的总时间                                                                                                                                                                                                                                                                                                                                                                                                        |
| USER_IO_WAIT_TIME       | bigint(20) unsigned | NO             | 所有 user_io 类事件的总时间                                                                                                                                                                                                                                                                                                                                                                                                            |
| SCHEDULE_TIME           | bigint(20) unsigned | NO             | 所有 Schedule 类事件的时间                                                                                                                                                                                                                                                                                                                                                                                                            |
| ROW_CACHE_HIT           | bigint(20)          | NO             | 行缓存命中次数                                                                                                                                                                                                                                                                                                                                                                                                                       |
| BLOOM_FILTER_CACHE_HIT  | bigint(20)          | NO             | bloom filter 缓存命中次数                                                                                                                                                                                                                                                                                                                                                                                                           |
| BLOCK_CACHE_HIT         | bigint(20)          | NO             | 块缓存命中次数                                                                                                                                                                                                                                                                                                                                                                                                                       |
| BLOCK_INDEX_CACHE_HIT   | bigint(20)          | NO             | 块索引缓存命中次数                                                                                                                                                                                                                                                                                                                                                                                                                     |
| DISK_READS              | bigint(20)          | NO             | 物理读次数                                                                                                                                                                                                                                                                                                                                                                                                                         |
| RETRY_CNT               | bigint(20)          | NO             | 重试次数                                                                                                                                                                                                                                                                                                                                                                                                                          |
| TABLE_SCAN              | tinyint(4)          | NO             | 判断该请求是否含全表扫描                                                                                                                                                                                                                                                                                                                                                                                                                  |
| CONSISTENCY_LEVEL       | bigint(20)          | NO             | 一致性级别                                                                                                                                                                                                                                                                                                                                                                                                                         |
| MEMSTORE_READ_ROW_COUNT | bigint(20)          | NO             | MEMSTORE 中的读行数                                                                                                                                                                                                                                                                                                                                                                                                                |
| SSSTORE_READ_ROW_COUNT  | bigint(20)          | NO             | SSSTORE 中连读的行数                                                                                                                                                                                                                                                                                                                                                                                                                |
| REQUEST_MEMORY_USED     | bigint(20)          | NO             | 该请求消耗的内存                                                                                                                                                                                                                                                                                                                                                                                                                      |
| EXPECTED_WORKER_COUNT   | bigint(20)          | NO             | 请求期望的工作线程数                                                                                                                                                                                                                                                                                                                                                                                                                    |
| USED_WORKER_COUNT       | bigint(20)          | NO             | 请求实际使用的工作线程数                                                                                                                                                                                                                                                                                                                                                                                                                  |
| SCHED_INFO              | varchar(16384)      | NO             | 请求的调度信息                                                                                                                                                                                                                                                                                                                                                                                                                       |
| FUSE_ROW_CACHE_HIT      | bigint(20)          | NO             | 暂不支持该字段，字段默认为 NULL                                                                                                                                                                                                                                                                                                                                                                                                            |
| PS_STMT_ID              | bigint(20)          | NO             | 请求对应的 prepare id                                                                                                                                                                                                                                                                                                                                                                                                              |
| TRANSACTION_HASH        | bigint(20) unsigned | NO             | 请求对应的事务的 Hash 值                                                                                                                                                                                                                                                                                                                                                                                                               |
| REQUEST_TYPE            | bigint(20)          | NO             | 请求对应的类型： * 0：表示非法   * 1：表示是一个内部请求   * 2：表示是一个本地请求，例如，Local 计划   * 3：表示远程请求   * 4：表示分布式请求   * 5：表示 SQL 的 prepare 请求   * 6：表示 SQL 得到 execute stmt 请求    |
| IS_BATCHED_MULTI_STMT   | tinyint(4)          | NO             | 是否进行 batch multi stmt 的优化                                                                                                                                                                                                                                                                                                                                                                                                     |
| OB_TRACE_INFO           | varchar(4096)       | NO             | 用户设置的 Trace 信息                                                                                                                                                                                                                                                                                                                                                                                                                |
| PLAN_HASH               | bigint(20) unsigned | NO             | 执行计划的 Hash 值                                                                                                                                                                                                                                                                                                                                                                                                                  |
| LOCK_FOR_READ_TIME      | bigint(20)          | NO             | 读取数据时等待锁的耗时，单位：微秒                                                                                                                                                                                                                                                                                                                                                                                                             |
| WAIT_TRX_MIGRATE_TIME   | bigint(20)          | NO             | 写入数据时，等待事务因为内部合并机制而需要冻结，冻结过程中位完成的事务需要搬迁出来的耗时，单位：微秒                                                                                                                                                                                                                                                                                                                                                                            |



